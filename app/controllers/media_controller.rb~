class MediaController < ApplicationController
  before_action :signed_in_user, only: [:destroy,:edit,:update,:create]
  before_action :correct_user, only: [:destroy,:edit,:update]
  def create
    @medium = current_user.media.build(media_params)
    if @medium.save
      flash[:success]="posted!"
      redirect_to user_path(current_user)
    else
      redirect_to  user_path(current_user)
    end
    
  end
 
  def edit
  end
  
  def update
   @medium.update_attributes(media_params)
   render edit_medium_path params[:id]
  end

  def destroy
    @medium.destroy
    redirect_back_or root_path
  end

  def conttyp
    @media = Medium.where(media_id:params[:id]).page(params[:page]).per(12)
  end


  private 

    def media_params
      params.require(:medium).permit(:content,:media_id,:title)
    end

    def correct_user
      if current_user.admin?
        @medium = Medium.find_by(id: params[:id]) 
      else
        @medium = current_user.media.find_by(id:params[:id])
      end
      redirect_to(root_path) if @medium.nil?
    end
end
